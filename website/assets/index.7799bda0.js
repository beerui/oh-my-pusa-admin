import{_ as re,d as ie,j as ce,r as f,X as de,m as R,v as fe,b as s,o as m,e as F,f as e,w as t,g as h,h as _,B as V,D as E,F as q,A as U,c as w,i as me,M as S,S as _e}from"./index.8af38bd5.js";import{q as pe,a as ve,b as ge,c as be,d as he,e as ye}from"./question.6be7f625.js";const Be=[{title:"\u6807\u9898",align:"left",colKey:"title",fixed:"left"},{title:"\u7C7B\u522B",align:"left",colKey:"tag",fixed:"left",cell:{col:"tag"}},{align:"left",fixed:"right",width:200,colKey:"op",title:"\u64CD\u4F5C"}];const Ce={class:"left-operation-container"},Fe=["onClick"],we=["onClick"],ke={class:"form-basic-container"},xe={class:"form-basic-item"},Ve={name:"ListQuestion"},Ee=ie({...Ve,setup(qe){const $=ce(),r=f([]),k=async()=>{if(r.value.length!==0)return Promise.resolve(r.value);const u=await pe();return r.value=u.rows,Promise.resolve(r.value)},j=u=>{if(r.value.length===0)return"";const n=o=>r.value.findIndex(i=>i.id===o);return u?n(u)<0?"-":r.value[n(u)].name:"*"},l=de({title:"",section:[],answer:"",tag:""}),O={title:[{required:!0,message:"\u6B64\u9879\u5FC5\u586B",type:"error",trigger:"blur"}],section:[{required:!0,message:"\u6B64\u9879\u5FC5\u9009",type:"error",trigger:"blur"}],answer:[{required:!0,message:"\u6B64\u9879\u5FC5\u9009",type:"error",trigger:"blur"}],tag:[{required:!0,message:"\u6B64\u9879\u5FC5\u9009",type:"error",trigger:"blur"}]},Q=()=>{},X=({validateResult:u})=>{if(u===!0&&(g.value==="add"&&ve(l).then(n=>{S.success("\u65B0\u5EFA\u6210\u529F"),l.title="",l.section=[],l.answer="",l.tag=""}).catch(n=>{console.log(n)}),g.value==="edit")){const n=l.section.map(i=>({name:i.name})),o={...l,section:n};ge(o).then(i=>{S.success("\u66F4\u65B0\u6210\u529F"),v.value=!1}).catch(i=>{console.log(i)})}},D=f([]),G=()=>{l.section.push({name:""})},H=u=>{l.section.splice(u,1)},p=f({defaultPageSize:20,pageSize:20,current:1,total:0,defaultCurrent:1}),x=f(!1),y=async()=>{x.value=!0;try{const{rows:u,count:n}=await be({page:p.value.current,size:p.value.pageSize});D.value=u,p.value={...p.value,total:n}}catch(u){console.log(u)}finally{x.value=!1}},c=f(-1),J=R(()=>c.value>-1?"\u5220\u9664\u786E\u8BA4\uFF1F":"");fe(()=>{k(),y()});const B=f(!1),A=()=>{c.value=-1},T=async()=>{c.value!==-1&&(await he(c.value),y(),S.success("\u5220\u9664\u6210\u529F"),B.value=!1),A()},v=f(!1),g=f("add"),L=()=>{A()},W="id",Y=u=>{p.value={...u}},Z=()=>{y()},ee=async()=>{g.value="add",r.value.length===0&&await k(),v.value=!0},te=u=>{c.value=u.row.id,B.value=!0},ae=async u=>{g.value="edit",r.value.length===0&&await k(),c.value=u.row.id,l.id=Number(c.value),ye(c.value).then(n=>{for(const o in n)l[o]=n[o];v.value=!0})},ne=R(()=>$.isUseTabsRouter?48:0),le=()=>document.querySelector(`.${_e}-layout`);return(u,n)=>{const o=s("t-button"),i=s("t-row"),N=s("t-tag"),ue=s("t-table"),oe=s("t-card"),I=s("t-dialog"),K=s("t-textarea"),C=s("t-form-item"),d=s("t-col"),M=s("t-option"),P=s("t-select"),se=s("t-form");return m(),F("div",null,[e(oe,{class:"list-card-container"},{default:t(()=>[e(i,{justify:"space-between"},{default:t(()=>[h("div",Ce,[e(o,{onClick:ee},{default:t(()=>[_(" \u65B0\u589E ")]),_:1}),e(o,{onClick:y},{default:t(()=>[_(" \u5237\u65B0 ")]),_:1})])]),_:1}),e(ue,{data:D.value,columns:V(Be),"row-key":W,"vertical-align":"top",hover:!0,pagination:p.value,loading:x.value,"header-affixed-top":{offsetTop:V(ne),container:le},onPageChange:Y,onChange:Z},{tag:t(({row:a})=>[e(N,{class:"m-5",theme:"success",variant:"light"},{default:t(()=>[_(E(j(a.tag)),1)]),_:2},1024)]),op:t(a=>[h("a",{class:"t-button-link",onClick:b=>ae(a)},"\u4FEE\u6539",8,Fe),h("a",{class:"t-button-link",onClick:b=>te(a)},"\u5220\u9664",8,we)]),_:1},8,["data","columns","pagination","loading","header-affixed-top"])]),_:1}),e(I,{visible:B.value,"onUpdate:visible":n[0]||(n[0]=a=>B.value=a),header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\uFF1F",body:V(J),"on-cancel":L,onConfirm:T},null,8,["visible","body"]),e(I,{visible:v.value,"onUpdate:visible":n[4]||(n[4]=a=>v.value=a),header:g.value==="add"?"\u65B0\u589E":"\u7F16\u8F91",footer:!1,width:"60%","on-cancel":L,onConfirm:T},{default:t(()=>[e(se,{ref:"form",class:"base-form",data:l,rules:O,"label-align":"left","label-width":60,onReset:Q,onSubmit:X},{default:t(()=>[h("div",ke,[h("div",xe,[e(i,{class:"row-gap",gutter:[0,6]},{default:t(()=>[e(d,{span:12},{default:t(()=>[e(C,{label:"\u9898\u76EE",name:"title"},{default:t(()=>[e(K,{modelValue:l.title,"onUpdate:modelValue":n[1]||(n[1]=a=>l.title=a),placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(C,{label:"\u9009\u9879",name:"section"},{default:t(()=>[e(o,{onClick:G},{default:t(()=>[_("\u65B0\u589E\u9009\u9879")]),_:1})]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[(m(!0),F(q,null,U(l.section,(a,b)=>(m(),w(i,{style:{"margin-bottom":"3px"}},{default:t(()=>[e(d,{span:2},{default:t(()=>[e(N,null,{default:t(()=>[_("\u9009\u9879 "+E(b),1)]),_:2},1024)]),_:2},1024),e(d,{span:8},{default:t(()=>[e(K,{modelValue:a.name,"onUpdate:modelValue":z=>a.name=z,placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(d,{span:2},{default:t(()=>[e(o,{style:{"margin-left":"10px"},onClick:z=>H(b)},{default:t(()=>[_("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1}),v.value?(m(),w(d,{key:0,span:12},{default:t(()=>[e(C,{label:"\u7B54\u6848",name:"answer"},{default:t(()=>[e(P,{modelValue:l.answer,"onUpdate:modelValue":n[2]||(n[2]=a=>l.answer=a),placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(m(!0),F(q,null,U(l.section,(a,b)=>(m(),w(M,{key:a.name,value:b,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):me("v-if",!0),e(d,{span:12},{default:t(()=>[e(C,{label:"\u6807\u7B7E",name:"tag"},{default:t(()=>[e(P,{modelValue:l.tag,"onUpdate:modelValue":n[3]||(n[3]=a=>l.tag=a),placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(m(!0),F(q,null,U(r.value,a=>(m(),w(M,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),e(o,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:t(()=>[_(E(g.value==="add"?"\u65B0\u589E":"\u66F4\u65B0"),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}});var De=re(Ee,[["__scopeId","data-v-1e6a61b4"],["__file","/Users/motou/Desktop/project/oh-my-pusa-admin/src/pages/list/question/index.vue"]]);export{De as default};
