import{_ as oe,d as le,j as ne,r as i,X as ue,m as T,v as se,b as n,o as b,e as q,f as t,w as a,g as B,h as C,B as F,D as L,F as re,A as ie,c as ce,M as w,S as de}from"./index.340c67b5.js";import{q as fe,s as _e,f as me,g as ve,h as ge,i as pe}from"./question.6be1a356.js";const he=[{title:"\u6807\u9898",align:"left",colKey:"title",fixed:"left"},{title:"\u7C7B\u522B",align:"left",colKey:"tag",fixed:"left",cell:{col:"tag"}},{align:"left",fixed:"right",width:200,colKey:"op",title:"\u64CD\u4F5C"}];const ye={class:"left-operation-container"},be=["onClick"],Be=["onClick"],Ce={name:"ListStory"},Fe=le({...Ce,setup(we){const N=ne(),s=i([]),p=async()=>{if(s.value.length!==0)return Promise.resolve(s.value);const o=await fe();return s.value=o.rows,Promise.resolve(s.value)},A=o=>{if(s.value.length===0)return"";const e=c=>s.value.findIndex(m=>m.id===c);return o?e(o)<0?"-":s.value[e(o)].name:"*"},u=ue({title:"",content:"",tag:""}),I={title:[{required:!0,message:"\u6B64\u9879\u5FC5\u586B",type:"error",trigger:"blur"}],content:[{required:!0,message:"\u6B64\u9879\u5FC5\u9009",type:"error",trigger:"blur"}],tag:[{required:!0,message:"\u6B64\u9879\u5FC5\u9009",type:"error",trigger:"blur"}]},K=()=>{console.log("reset")},M=({validateResult:o})=>{o===!0&&(_.value==="add"&&_e(u).then(e=>{w.success("\u65B0\u5EFA\u6210\u529F"),f.value=!1,v()}).catch(e=>{console.log(e)}),_.value==="edit"&&me(u).then(e=>{w.success("\u66F4\u65B0\u6210\u529F"),f.value=!1}).catch(e=>{console.log(e)}))},x=i([]),d=i({defaultPageSize:20,pageSize:20,current:1,total:0,defaultCurrent:1}),h=i(!1),v=async()=>{h.value=!0;try{const{rows:o,total:e}=await ve({page:d.value.current,size:d.value.pageSize});x.value=o,d.value={...d.value,total:e}}catch(o){console.log(o)}finally{h.value=!1}},r=i(-1),P=T(()=>r.value>-1?"\u5220\u9664\u786E\u8BA4\uFF1F":"");se(()=>{p(),v()});const g=i(!1),k=()=>{r.value=-1},V=async()=>{r.value!==-1&&(await ge(r.value),v(),w.success("\u5220\u9664\u6210\u529F"),g.value=!1),k()},f=i(!1),_=i("add"),E=()=>{k()},z="id",R=o=>{d.value={...o}},j=()=>{v()},$=async()=>{_.value="add",s.value.length===0&&await p(),f.value=!0},O=o=>{r.value=o.row.id,g.value=!0},X=async o=>{_.value="edit",s.value.length===0&&await p(),r.value=o.row.id,u.id=Number(r.value),pe(r.value).then(e=>{for(const c in e)u[c]=e[c];f.value=!0})},G=T(()=>N.isUseTabsRouter?48:0),H=()=>document.querySelector(`.${de}-layout`);return(o,e)=>{const c=n("t-button"),m=n("t-form-item"),S=n("t-form"),D=n("t-row"),J=n("t-tag"),Q=n("t-table"),W=n("t-card"),U=n("t-dialog"),Y=n("t-textarea"),y=n("t-col"),Z=n("t-option"),ee=n("t-select"),te=n("v-md-editor");return b(),q("div",null,[t(W,{class:"list-card-container"},{default:a(()=>[t(D,{justify:"space-between"},{default:a(()=>[B("div",ye,[t(S,null,{default:a(()=>[t(m,{"label-width":"0"},{default:a(()=>[t(c,{onClick:$},{default:a(()=>[C(" \u65B0\u589E ")]),_:1})]),_:1})]),_:1})])]),_:1}),t(Q,{data:x.value,columns:F(he),"row-key":z,"vertical-align":"top",hover:!0,pagination:d.value,loading:h.value,"header-affixed-top":{offsetTop:F(G),container:H},onPageChange:R,onChange:j},{tag:a(({row:l})=>[t(J,{class:"m-5",theme:"success",variant:"light"},{default:a(()=>[C(L(A(Number(l.tag))),1)]),_:2},1024)]),op:a(l=>[B("a",{class:"t-button-link",onClick:ae=>X(l)},"\u4FEE\u6539",8,be),B("a",{class:"t-button-link",onClick:ae=>O(l)},"\u5220\u9664",8,Be)]),_:1},8,["data","columns","pagination","loading","header-affixed-top"])]),_:1}),t(U,{visible:g.value,"onUpdate:visible":e[0]||(e[0]=l=>g.value=l),header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\uFF1F",body:F(P),"on-cancel":E,onConfirm:V},null,8,["visible","body"]),t(U,{visible:f.value,"onUpdate:visible":e[4]||(e[4]=l=>f.value=l),header:_.value==="add"?"\u65B0\u589E":"\u7F16\u8F91",footer:!1,width:"80%","on-cancel":E,onConfirm:V},{default:a(()=>[t(S,{ref:"form",data:u,rules:I,"label-align":"left","label-width":60,onReset:K,onSubmit:M},{default:a(()=>[t(D,{class:"row-gap",gutter:[0,6]},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(m,{label:"\u6807\u9898",name:"title"},{default:a(()=>[t(Y,{modelValue:u.title,"onUpdate:modelValue":e[1]||(e[1]=l=>u.title=l),placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(m,{label:"\u6807\u7B7E",name:"tag"},{default:a(()=>[t(ee,{modelValue:u.tag,"onUpdate:modelValue":e[2]||(e[2]=l=>u.tag=l),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(b(!0),q(re,null,ie(s.value,l=>(b(),ce(Z,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(m,{label:"\u5185\u5BB9",name:"content"},{default:a(()=>[t(te,{modelValue:u.content,"onUpdate:modelValue":e[3]||(e[3]=l=>u.content=l),height:"400px"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(c,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:a(()=>[C(L(_.value==="add"?"\u65B0\u589E":"\u66F4\u65B0"),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}});var Ve=oe(Fe,[["__scopeId","data-v-67f8484b"],["__file","/Users/motou/Desktop/project/oh-my-pusa-admin/src/pages/list/story/index.vue"]]);export{Ve as default};
